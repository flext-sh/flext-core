
exclude = [
    "__pycache__",
    ".git",
    ".mypy_cache",
    ".pytest_cache",
    ".ruff_cache",
    ".venv",
    "archive",
    "backup",
    "build",
    "dist",
    "htmlcov",
    "temp-backup",
    "venv",
]
fix = true
preview = true
respect-gitignore = true
show-fixes = true
src = [
    "src",
]
target-version = "py313"
line-length = 88

[format]
    docstring-code-format = true
    indent-style          = "space"
    line-ending           = "lf"
    quote-style           = "double"

[lint]
    ignore = [
        "B009",    # get-attr-with-constant
        "B010",    # set-attr-with-constant
        "B017",    # assert-raises-exception
        "BLE001",  # blind-except
        "C901",    # complex-structure
        "COM812",
        "D203",    # incorrect-blank-line-before-class - conflicting with D211 (blank line before class)
        "D213",    # multi-line-summary-second-line - conflicting with D212 (summary line position)
        "D401",    # non-imperative-mood - too opinionated in multilingual codebase
        "E501",    # line-too-long
        "ERA001",  # commented-out-code - False positives on legitimate comments
        "G004",    # logging-f-string
        "PLR0911", # too-many-return-statements - Many returns allowed in some processors/validators
        "PLR0912", # too-many-branches - High complexity acceptable in orchestrators
        "PLR0913", # too-many-arguments - Too many arguments in function definition (sometimes necessary)
        "PLR0915", # too-many-statements - Many statements in some builder functions
        "PLR6301", # no-self-use
        "RUF002",  # ambiguous-unicode-character-docstring - false positives when using certain images
        "RUF003",  # ambiguous-unicode-character-comment
        "TC001",   # typing-only-first-party-import - Pydantic requirement
        "TC002",   # typing-only-third-party-import - Pydantic requirement
        "TC003",   # typing-only-standard-library-import - Pydantic requirement
        "TRY300",  # try-consider-else
        "TRY301",  # raise-within-try - Abstract raise
        "W293",
        "DOC201",
        "DOC501",
        "CPY001",
        "DOC402",
        "FBT003",
        "Q000",
        "TRY003",
        # "PLC0415",
        "RUF005",  # unpacking-operator - disabled to avoid pyrefly conflicts
        "PLR1702",
        "PLR0914",
        "PLR0904",
        "DOC202",
        "DOC502",
        "PLR0917",
        "D417",
    ]
    select = [
        "ALL",
    ]

[lint.isort]
    force-single-line       = false
    split-on-trailing-comma = true
    combine-as-imports      = true

[lint.per-file-ignores]
    "**/.vulture_whitelist.py" = [
        "ALL",
    ]
    "**/*_pb2*.py" = [
        "ALL",
    ]
    "**/config.py" = [
        "ANN401", # any-type - examples can legitimately use Any for Pydantic 2 models
        "FBT001", # Boolean positional argument - required by Pydantic field serializers
        "PLC0415", # allow lazy imports in fix circular imports in base level
    ]
    "**/constants.py" = [
        "S105", # hardcoded-password-string - false positives in error messages and descriptions
    ]
    "**/examples/**" = [
        "ANN401",  # any-type - examples can legitimately use Any for flexibility
        "EXE001",
        "FBT001",  # boolean-type-hint-positional-argument - examples use simple boolean args
        "FBT002",  # boolean-default-value-positional-argument - examples use boolean defaults
        "FIX002",  # line-contains-todo - examples may have legitimate TODOs
        "INP001",
        "N999",    # Invalid module name (examples use numbered prefixes)
        "PLR2004", # magic numbers in examples
        "S105",    # hardcoded-password-string - false positives in error code constants
        "S106",    # hardcoded-password-func-arg
        "T201",    # print
        "TID252",  # relative-imports
    ]
    "**/exceptions.py" = [
        "A001",   # variable-is-ambiguous - Allow ambiguous variable names in exceptions
        "PLC0415", # allow lazy imports in fix circular imports in base level
        "SLF001", # private-member-access - Allow private member access in exception classes
        "S105",   # hardcoded-password-string - false positives in error code constants
    ]
    "**/loggings.py" = [
        "PLC0415", # allow lazy imports in fix circular imports in base level
    ]
    "**/middleware.py" = [
        "ANN401",  # any-type - intentional to avoid circular imports between flext-auth/flext-api/flext-web
        "FBT001",  # boolean-type-hint-positional-argument - middleware configuration pattern
        "FBT002",  # boolean-default-value-positional-argument - middleware configuration pattern
        "PLC2801", # unnecessary-dunder-call - object.__setattr__ required for Pydantic extra="forbid"
        "S107",    # hardcoded-password-default - "Bearer" is HTTP protocol keyword, not password
    ]
    "**/models.py" = [
        "ANN401", # any-type - examples can legitimately use Any for Pydantic 2 models
        "FBT001", # Boolean positional argument - required by Pydantic field serializers
        "PLC0415", # allow lazy imports in fix circular imports in base level
    ]
    "**/result.py" = [
        "PLC0415", # allow lazy imports in fix circular imports in base level
    ]
    "**/scripts/**" = [
        "EXE001",
        "FIX002",  # line-contains-todo - scripts may have legitimate TODOs
        "INP001",
        "PLR0911",
        "PLR0912",
        "PLR0915",
        "PLR2004",
        "PLW2901", # redefined-loop-name - scripts may reassign loop variables
        "S105",    # hardcoded-password-string - false positives in scripts
        "S107",    # hardcoded-password-default
        "S603",    # subprocess-without-shell-equals-true - scripts need subprocess calls
        "T201",    # print
        "TID252",  # relative-imports

    ]
    "**/*tests*/**" = [
        "ARG001",   # Unused function argument (helper functions for testing)
        "ARG002",   # Unused method argument (test fixtures)
        "ARG005",   # Unused lambda argument (test lambdas)
        "B903",     # Dataclass suggestion (test classes don't need dataclass)
        "D102",    # Missing docstring in public method - test methods don't need docstrings
        "EM102",    # F-string in exception (test error messages)
        "FBT001",  # Boolean positional argument - acceptable in tests
        "FBT003",
        "FIX002",   # TODO comments are acceptable in tests
        "FURB118",  # operator usage (test readability more important)
        "INP001",   # Allow implicit namespace packages in tests
        "N818",     # Exception naming (custom test exceptions)
        "PLC0415",  # Import not at top (test-specific imports for isolation)
        "PLC2701",  # Private imports (testing internal implementation)
        "PLR0912",
        "PLR0915",
        "PLR2004",  # Magic values (test values are self-documenting)
        "PLW1641",  # Missing __hash__ (test objects don't need hashing)
        "PT011",
        "PT018",   # Assertion should be broken down - acceptable in tests for clarity
        "PT019",   # Fixture without value - fixtures are used in function body
        "RUF029",   # without (testing signatures)
        "S101",     # Assert usage (pytest standard pattern)
        "S103",
        "S104",
        "S105",
        "S106",
        "S107",
        "S108",    # Probable insecure usage of temp file - acceptable in tests
        "S112",
        "S311",
        "S404",    # subprocess-without-shell-equals-true - tests may need subprocess
        "S603",
        "S608",
        "SIM105",  # Use contextlib.suppress - tests may prefer explicit try/except
        "SIM117",   # Nested with statements (test readability)
        "SLF001",   # Private member access (testing internal implementation)
        "TD002",    # TODO author (not needed in tests)
        "TD003",
        "TID252",
        "TRY003",
        "TRY004",  # Prefer TypeError - test flexibility over strict exception types
    ]
    "**/__init__.py" = [
        "F822",    # undefined-name - lazy imports define names at runtime via __getattr__
        "PLC0415", # import-outside-top-level - lazy imports are intentional for circular import prevention
    ]
